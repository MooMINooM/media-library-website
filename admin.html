<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>body{font-family:'Sarabun',sans-serif;}</style>
</head>
<body class="bg-gray-50 min-h-screen">

    <nav class="bg-gradient-to-r from-blue-700 to-blue-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-2xl">‚öôÔ∏è</span>
                <h1 class="text-xl font-bold">Admin Panel</h1>
            </div>
            <button onclick="logout()" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg text-sm font-bold transition">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        
        <div class="bg-white rounded-xl shadow-md p-6 mb-8">
            <label class="block text-gray-700 text-lg font-bold mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</label>
            <select id="category-select" onchange="renderForm()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-gray-50 text-lg">
                <option value="" disabled selected>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <optgroup label="üì∞ ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå">
                    <option value="news">‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                </optgroup>
                <optgroup label="üë• ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£">
                    <option value="personnel">‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</option>
                    <option value="director_history">‡∏ó‡∏≥‡πÄ‡∏ô‡∏µ‡∏¢‡∏ö‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</option>
                    <option value="personnel_history">‡∏ó‡∏≥‡πÄ‡∏ô‡∏µ‡∏¢‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥)</option>
                </optgroup>
                <optgroup label="üèÜ ‡∏ú‡∏•‡∏á‡∏≤‡∏ô">
                    <option value="teacher_awards">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏π</option>
                    <option value="student_awards">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                    <option value="school_awards">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                </optgroup>
                <optgroup label="üí° ‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ & ‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                    <option value="innovations">‡∏Ñ‡∏•‡∏±‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°</option>
                    <option value="documents">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option>
                    <option value="forms">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</option>
                    <option value="board">‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                    <option value="council">‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                </optgroup>
            </select>
        </div>

        <div id="form-container" class="bg-white rounded-xl shadow-md p-6 hidden animate-fade-in-up">
            <h2 id="form-title" class="text-2xl font-bold text-blue-800 mb-6 border-b pb-2"></h2>
            <form id="data-form" class="space-y-4">
                <div id="dynamic-fields" class="grid grid-cols-1 gap-4">
                    </div>
                
                <div class="pt-4 flex gap-3">
                    <button type="button" onclick="submitData()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition shadow-lg transform hover:-translate-y-1">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                    <button type="reset" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold">‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
                </div>
            </form>
        </div>

    </div>

    <script>
        // ‚ö†Ô∏è ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏ó‡∏µ‡πà Deploy ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        const API_URL = 'https://script.google.com/macros/s/AKfycby7CsU7Kck9nUY-uC_R6unpMu9dDrOnuOaQUzi0fto4kSnYhl63xHmr7wrJXwDzxSotow/exec';

        // ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        const FORM_CONFIG = {
            news: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå", fields: [
                { name: "title", label: "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πà‡∏≤‡∏ß", type: "text" },
                { name: "date", label: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", type: "date" },
                { name: "link", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)", type: "url" },
                { name: "image", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏Å", type: "url" }
            ]},
            personnel: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", fields: [
                { name: "name", label: "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•", type: "text" },
                { name: "role", label: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏£‡∏π, ‡∏ú‡∏≠.)", type: "text" },
                { name: "academic", label: "‡∏ß‡∏¥‡∏ó‡∏¢‡∏ê‡∏≤‡∏ô‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£)", type: "text" },
                { name: "class", label: "‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)", type: "text" },
                { name: "image", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå", type: "url" }
            ]},
            teacher_awards: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏π", fields: [
                { name: "name", label: "‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π", type: "text" },
                { name: "project", label: "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏•‡∏á‡∏≤‡∏ô/‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•", type: "text" },
                { name: "level", label: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏≤‡∏ï‡∏¥)", type: "text" },
                { name: "date", label: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", type: "date" },
                { name: "image", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏ú‡∏•‡∏á‡∏≤‡∏ô", type: "url" }
            ]},
            student_awards: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", fields: [
                { name: "title", label: "‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•", type: "text" },
                { name: "students", label: "‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", type: "text" },
                { name: "subject", label: "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Ø", type: "text" },
                { name: "level", label: "‡∏£‡∏∞‡∏î‡∏±‡∏ö", type: "text" },
                { name: "image", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏ú‡∏•‡∏á‡∏≤‡∏ô", type: "url" }
            ]},
            innovations: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°", fields: [
                { name: "title", label: "‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°", type: "text" },
                { name: "creator", label: "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥", type: "text" },
                { name: "category", label: "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà", type: "text" },
                { name: "subject", label: "‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤", type: "text" },
                { name: "link", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î/‡∏î‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô", type: "url" },
                { name: "coverImageUrl", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏õ‡∏Å", type: "url" }
            ]},
            documents: { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", fields: [
                { name: "title", label: "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", type: "text" },
                { name: "category", label: "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á/‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®)", type: "text" },
                { name: "uploadDate", label: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", type: "date" },
                { name: "fileUrl", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå (PDF/Drive)", type: "url" }
            ]},
            // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ pattern ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
        };
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏° Default Config ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Form ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        const DEFAULT_CONFIG = { title: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", fields: [
            { name: "title", label: "‡∏ä‡∏∑‡πà‡∏≠/‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠", type: "text" },
            { name: "description", label: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", type: "text" },
            { name: "link", label: "‡∏•‡∏¥‡∏á‡∏Å‡πå", type: "url" }
        ]};

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Login
        if (localStorage.getItem('isLoggedIn') !== 'true') window.location.href = 'index.html';
        function logout() { localStorage.removeItem('isLoggedIn'); window.location.href = 'index.html'; }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        function renderForm() {
            const category = document.getElementById('category-select').value;
            const container = document.getElementById('form-container');
            const titleEl = document.getElementById('form-title');
            const fieldsContainer = document.getElementById('dynamic-fields');
            
            if (!category) { container.classList.add('hidden'); return; }

            // ‡∏î‡∏∂‡∏á Config ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Default ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ
            const config = FORM_CONFIG[category] || DEFAULT_CONFIG;
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠
            titleEl.textContent = config.title;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            fieldsContainer.innerHTML = config.fields.map(field => `
                <div>
                    <label class="block text-gray-700 font-semibold mb-1">${field.label}</label>
                    <input type="${field.type}" name="${field.name}" 
                           class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 transition" 
                           placeholder="${field.label}..." required>
                </div>
            `).join('');

            container.classList.remove('hidden');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        async function submitData() {
            const category = document.getElementById('category-select').value;
            const form = document.getElementById('data-form');
            const btn = document.querySelector('button[onclick="submitData()"]');
            
            if (!form.checkValidity()) {
                Swal.fire('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'warning');
                return;
            }

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const formData = new FormData(form);
            const dataObj = Object.fromEntries(formData.entries());
            
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
            const originalBtnText = btn.innerHTML;
            btn.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            btn.disabled = true;

            try {
                // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏´‡∏≤ Google Apps Script
                await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'addData',
                        type: category, // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ category ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ Sheet
                        data: dataObj
                    })
                });

                Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
                form.reset();
            } catch (error) {
                Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', error.message, 'error');
            } finally {
                btn.innerHTML = originalBtnText;
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
