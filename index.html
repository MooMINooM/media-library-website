<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö - ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">

    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Navigation Bar -->
    <nav class="bg-white shadow-md sticky top-0 z-20">
        <div class="container mx-auto px-4 md:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-book-open text-indigo-600 text-2xl"></i>
                    <a href="#" class="text-xl font-bold text-gray-800">‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</a>
                </div>
                <div class="relative" id="menu-dropdown-container">
                    <button id="menu-dropdown-btn" class="flex items-center space-x-2 text-gray-600 hover:text-indigo-600 focus:outline-none p-2 rounded-md">
                        <span>‡πÄ‡∏°‡∏ô‡∏π</span>
                        <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                    </button>
                    <div id="menu-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 ring-1 ring-black ring-opacity-5">
                        <a href="library.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-indigo-600">
                            <i class="fas fa-photo-video w-4 mr-2"></i>‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <main class="hero-section">
        <h1 class="text-5xl md:text-7xl font-extrabold text-gray-800 tracking-tight">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h1>
        <p class="mt-6 text-lg md:text-xl max-w-2xl text-gray-600">
            ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô
        </p>
        <a href="library.html" class="hero-button">
            ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠ <i class="fas fa-arrow-right ml-2"></i>
        </a>
    </main>

    <!-- Latest Media Section -->
    <section id="latest-media" class="py-16 bg-white">
        <div class="container mx-auto px-4 md:px-8 text-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-2">‡∏™‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
            <p class="text-gray-600 mb-12">‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</p>
            <div id="latest-media-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Loading placeholders -->
                <div class="animate-pulse bg-gray-200 rounded-xl h-80"></div>
                <div class="animate-pulse bg-gray-200 rounded-xl h-80"></div>
                <div class="animate-pulse bg-gray-200 rounded-xl h-80 hidden sm:block"></div>
                <div class="animate-pulse bg-gray-200 rounded-xl h-80 hidden lg:block"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white py-6 border-t">
        <div class="container mx-auto text-center text-gray-500">
            <p>&copy; 2025 ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•. ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤.</p>
        </div>
    </footer>

    <script>
        // Script for Dropdown Menu
        const menuDropdownBtn = document.getElementById('menu-dropdown-btn');
        const menuDropdown = document.getElementById('menu-dropdown');
        const menuDropdownIcon = menuDropdownBtn.querySelector('i');

        menuDropdownBtn.addEventListener('click', (event) => {
            event.stopPropagation();
            menuDropdown.classList.toggle('hidden');
            menuDropdownIcon.classList.toggle('rotate-180');
        });

        window.addEventListener('click', (event) => {
            if (!menuDropdownBtn.contains(event.target)) {
                menuDropdown.classList.add('hidden');
                menuDropdownIcon.classList.remove('rotate-180');
            }
        });

        // Script for Fetching Latest Media
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxgxfZ5SB9Um4HftajMJS6RJMG9kwd6hVjKz_DYTxDgQOB9qk1Xxl0mS1dr5YuoIFi-/exec';
        const latestMediaContainer = document.getElementById('latest-media-container');

        async function fetchLatestMedia() {
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getLatestMedia`);
                if (!response.ok) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÑ‡∏î‡πâ');
                
                const latestMedia = await response.json();
                latestMediaContainer.innerHTML = ''; // Clear placeholders

                // --- FIX START ---
                // Add a check to ensure latestMedia is an array before using forEach
                if (Array.isArray(latestMedia)) {
                    if (latestMedia.length === 0) {
                        latestMediaContainer.innerHTML = '<p class="col-span-full text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>';
                        return;
                    }

                    latestMedia.forEach(media => {
                        const card = document.createElement('a');
                        card.href = `library.html`; // ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠
                        card.className = 'media-card bg-white rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 block text-left';
                        
                        const coverImage = media['‡∏£‡∏π‡∏õ‡∏õ‡∏Å‡∏™‡∏∑‡πà‡∏≠'] || 'https://placehold.co/600x400/e2e8f0/64748b?text=‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û';

                        card.innerHTML = `
                            <img src="${coverImage}" alt="${media['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏∑‡πà‡∏≠']}" class="w-full h-48 object-cover">
                            <div class="p-5">
                                <div class="flex flex-wrap gap-2 mb-2">
                                    <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200">${media['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏∑‡πà‡∏≠ (‡∏ß‡∏¥‡∏ä‡∏≤)'] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>
                                </div>
                                <h3 class="text-lg font-bold mb-2 truncate" title="${media['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏∑‡πà‡∏≠']}">${media['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏∑‡πà‡∏≠']}</h3>
                            </div>
                        `;
                        latestMediaContainer.appendChild(card);
                    });
                } else {
                    // If the data is not an array, throw an error.
                    throw new Error('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                }
                // --- FIX END ---

            } catch (error) {
                latestMediaContainer.innerHTML = `<p class="col-span-full text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</p>`;
                console.error(error);
            }
        }
        
        window.addEventListener('load', fetchLatestMedia);
    </script>
</body>
</html>

